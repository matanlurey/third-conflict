(this["webpackJsonpthird-conflict"]=this["webpackJsonpthird-conflict"]||[]).push([[0],{114:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),a=n.n(r).a.createContext(null)},134:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(108),a=n(107),s=n(31),i=n(30),c=n(66),u=n(37),o=n(42),l=n(60),h=function(){function e(t){Object(u.a)(this,e),this.data=t}return Object(o.a)(e,[{key:"distance",value:function(e){var t=[this.x,this.y],n=t[0],r=t[1],a=e instanceof Array?e:[e.x,e.y],s=Object(i.a)(a,2),c=s[0],u=s[1];return parseFloat(Math.sqrt(Math.pow(c-n,2)+Math.pow(u-r,2)).toFixed(2))}},{key:"x",get:function(){return this.data[0]}},{key:"y",get:function(){return this.data[1]}}]),e}(),f=n(89),j=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r,a){var s;return Object(u.a)(this,n),(s=t.call(this,r,a)).sampler=void 0,s.sampler=Array.isArray(e)?new f.a(e,4,void 0,r):e,s}return Object(o.a)(n,[{key:"generateMap",value:function(e,t){var n=this,r=this.fetchNames(e);r.sort((function(){return n.prando.nextInt(-1,1)}));for(var a=this.sampler.points(e),s=[],i=0;i<a.length;i++)s.push({name:r[i],position:[Math.max(Math.ceil(a[i][0]-1),0),Math.max(Math.ceil(a[i][1]-1),0)],home:!1});for(;t--;)this.pickFairestHomeSystem(s).home=!0;return this.reducePositionsToOrigin(s)}}]),n}(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new l.a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["Alfa","Bravo","Charlie","Delta","Echo","Foxtrot","Golf","Hotel","India","Juliett","Kilo","Lima","Mike","November","Oscar","Papa","Quebec","Romeo","Sierra","Tango","Uniform","Victor","Whiskey","Xray","Yankee","Zulu"];Object(u.a)(this,e),this.prando=t,this.names=n}return Object(o.a)(e,[{key:"fetchNames",value:function(e){return this.names.slice(0,e)}},{key:"computeDistanceWeight",value:function(e,t,n){var r=e-t;return n&&(r=Math.pow(2,r)),r}},{key:"pickFairestHomeSystem",value:function(e){var t,n,r=Number.MAX_SAFE_INTEGER,a=0,s=Object(c.a)(e);try{for(s.s();!(n=s.n()).done;){var i,u=n.value,o=Object(c.a)(e);try{for(o.s();!(i=o.n()).done;){var l=i.value,f=new h(u.position).distance(l.position);f>a&&(a=f)}}catch(k){o.e(k)}finally{o.f()}}}catch(k){s.e(k)}finally{s.f()}var j,p=Object(c.a)(e);try{for(p.s();!(j=p.n()).done;){var d=j.value;if(!d.home){var b,m=[],O=Object(c.a)(e);try{for(O.s();!(b=O.n()).done;){var x=b.value,v=new h(d.position).distance(x.position),y=this.computeDistanceWeight(a,v,!!x.home);m.push(y)}}catch(k){O.e(k)}finally{O.f()}var g=m.reduce((function(e,t){return e+t}),0);g<r&&(r=g,t=d)}}}catch(k){p.e(k)}finally{p.f()}if(!t){var w=e.filter((function(e){return!e.home}));if(0===w.length)throw new Error("Failed to find an open system.");t=this.prando.nextArrayItem(w)}return t}},{key:"reducePositionsToOrigin",value:function(e){var t,n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,a=Object(c.a)(e);try{for(a.s();!(t=a.n()).done;){var u=t.value,o=Object(i.a)(u.position,2),l=o[0],h=o[1];l<n&&(n=l),h<r&&(r=h)}}catch(f){a.e(f)}finally{a.f()}return e.map((function(e){var t=Object(i.a)(e.position,2),a=t[0],c=t[1];return a-=n,c-=r,Object(s.a)(Object(s.a)({},e),{},{position:[a,c]})}))}}]),e}())},173:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var r=n(4),a=n(30),s=n(355),i=n(207),c=n(356),u=n(154),o=n(63),l=n(49),h=n(0),f=n(354),j=n(199),p=n(48),d=n(33),b=(n(216),n(114)),m=n(174),O=n(182),x=n(202),v=n(198);var y=Object(j.hot)(e)((function(){var e=Object(f.a)(["auth"]),t=Object(a.a)(e,2),n=t[0],j=t[1],y=Object(h.useState)(n.auth),g=Object(a.a)(y,2),w=g[0],k=g[1];return Object(r.jsx)(p.a,{children:Object(r.jsxs)(u.a,{children:[Object(r.jsxs)(u.a.Header,{children:[Object(r.jsx)("div",{className:"logo",children:Object(r.jsx)(p.b,{to:"/",children:Object(r.jsx)("img",{src:"/images/logo.png"})})}),Object(r.jsxs)(o.a,{theme:"dark",mode:"horizontal",selectable:!1,children:[Object(r.jsx)(o.a.Item,{disabled:!w,icon:Object(r.jsx)(s.a,{}),children:Object(r.jsx)(p.b,{to:"/games",children:"Games"})}),Object(r.jsx)(o.a.Item,{icon:Object(r.jsx)(i.a,{}),children:Object(r.jsx)(p.b,{to:"/account",children:"Account"})}),Object(r.jsx)(o.a.Item,{icon:Object(r.jsx)(c.a,{}),children:Object(r.jsx)(p.b,{to:"/settings",children:"Settings"})})]})]}),Object(r.jsx)(b.a.Provider,{value:w,children:Object(r.jsx)(u.a.Content,{children:Object(r.jsxs)(d.c,{children:[Object(r.jsx)(d.a,{path:"/games",component:x.a}),Object(r.jsx)(d.a,{path:"/account",children:Object(r.jsx)(m.a,{onChange:function(e){j("auth",e),k(e)}})}),Object(r.jsx)(d.a,{path:"/settings",component:v.a}),Object(r.jsx)(d.a,{path:"/",children:w?Object(r.jsx)(O.a,{}):Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(l.a,{type:"dashed",children:Object(r.jsxs)(p.b,{to:"/account",children:[Object(r.jsx)(i.a,{})," Login Required"]})})})})]})})})]})})}))}).call(this,n(215)(e))},174:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(4),a=n(136),s=n(49),i=n(0),c=n(114);n(217);function u(e){var t=Object(i.useContext)(c.a);return Object(r.jsxs)(a.a,{className:"account-form",labelCol:{span:8},wrapperCol:{span:16},children:[Object(r.jsx)("h1",{children:"Account"}),Object(r.jsxs)("p",{children:["A login is required to play ",Object(r.jsx)("strong",{children:"Third Conflict"}),". Currently you can login as a ",Object(r.jsx)("strong",{children:"Guest"})," and create and play games locally. In ",Object(r.jsx)("em",{children:"future"})," releases you will be able to login with"," ",Object(r.jsx)("strong",{children:"Discord"})," and play online."]}),!t&&Object(r.jsxs)(a.a.Item,{children:[Object(r.jsx)(s.a,{type:"primary",onClick:function(){return e.onChange("Guest")},children:"Login as Guest"}),Object(r.jsx)(s.a,{type:"ghost",disabled:!0,children:"Login with Discord"})]}),t&&Object(r.jsx)(s.a,{type:"primary",danger:!0,onClick:function(){return e.onChange(null)},children:"Logout"})]})}},182:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(4),a=n(8),s=n.n(a),i=n(20),c=n(30),u=n(0),o=n(48),l=n(65);n(307);function h(){var e=Object(u.useContext)(l.a),t=Object(u.useState)(),n=Object(c.a)(t,2),a=n[0],h=n[1];return Object(u.useEffect)((function(){Object(i.a)(s.a.mark((function t(){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.gamesList();case 2:n=t.sent,h(n.length);case 4:case"end":return t.stop()}}),t)})))()}),[e]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("h1",{children:["Welcome back to ",Object(r.jsx)("strong",{children:"Third Conflict"})]}),Object(r.jsxs)("p",{children:["You have ",Object(r.jsxs)(o.b,{to:"/games",children:[a," pending game(s)"]}),"."]})]})}},198:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),a=n(136),s=n(49);n(0),n(351);function i(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:"Settings"}),Object(r.jsx)("p",{children:"This game is in active development. As such, the data model is constantly evolving, and it's possible to get into a state where you have invalid data and the app/game is no longer functioning properly."}),Object(r.jsx)(a.a,{className:"account-form",labelCol:{span:8},wrapperCol:{span:16},children:Object(r.jsx)(a.a.Item,{children:Object(r.jsx)(s.a,{type:"primary",danger:!0,onClick:function(){localStorage.clear(),location.replace("/")},children:"Reset all data"})})})]})}},202:function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var r=n(8),a=n.n(r),s=n(4),i=n(20),c=n(30),u=n(49),o=n(0),l=n(33),h=n(65),f=(n(311),n(364)),j=n(136),p=n(361),d=n(362),b=n(132),m=n(37),O=n(42),x=n(60),v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new x.a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["angry","attractive","bald","big","brave","clumsy","fierce","happy","itchy","handsome","petite","repulsive","silly","stocky","tall","tiny","wonderful","zealous"],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["antelope","cat","dog","eagle","gorilla","lion","rabbit","snake","tiger","vulture","zebra"];Object(m.a)(this,e),this.rng=t,this.adjectives=n,this.nouns=r}return Object(O.a)(e,[{key:"next",value:function(){return"".concat(this.rng.nextArrayItem(this.adjectives),"-").concat(this.rng.nextArrayItem(this.nouns),"-").concat(this.rng.nextInt(0,99).toString().padStart(2,"0"))}}]),e}();function y(){var e=j.a.useForm(),t=Object(c.a)(e,1)[0],n=Object(l.f)().replace,r=Object(o.useContext)(h.a),m=Object(o.useState)(!1),O=Object(c.a)(m,2),x=O[0],y=O[1];return Object(o.useEffect)((function(){t.setFieldsValue({name:(new v).next(),players:2})}),[]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Create a Game"}),Object(s.jsxs)("p",{children:["Currently, you can create ",Object(s.jsx)("strong",{children:"local"})," (offline) games with AI opponents. In future builds, once logged in with"," ",Object(s.jsx)("strong",{children:"Discord"}),", you will be able to create and play online games."]}),Object(s.jsxs)(j.a,{labelCol:{span:1},wrapperCol:{span:4},form:t,onFinish:function(){var e=Object(i.a)(a.a.mark((function e(t){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,r.gamesCreate(t.name,t.players);case 3:s=e.sent,n("/games/".concat(s.name));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(s.jsx)(j.a.Item,{name:"name",label:"Name",extra:Object(s.jsx)(s.Fragment,{children:"This name is just used for reference only."}),children:Object(s.jsx)(p.a,{maxLength:30})}),Object(s.jsx)(j.a.Item,{name:"players",label:"Players",extra:Object(s.jsx)(s.Fragment,{children:"2-4 players currently supported."}),children:Object(s.jsx)(d.a,{min:2,max:4})}),Object(s.jsx)(j.a.Item,{name:"online",label:"Connectivity",extra:Object(s.jsx)(s.Fragment,{children:"Local games are versus AI and played offline."}),children:Object(s.jsxs)(b.a.Group,{children:[Object(s.jsx)(b.a.Button,{value:!1,children:"Local"}),Object(s.jsx)(b.a.Button,{value:!0,disabled:!0,children:"Online"})]})}),Object(s.jsx)(j.a.Item,{wrapperCol:{span:5},children:Object(s.jsx)(u.a,{disabled:x,icon:x?Object(s.jsx)(f.a,{}):void 0,type:"primary",style:{width:"100%"},htmlType:"submit",children:x?Object(s.jsx)(s.Fragment,{children:"Saving"}):Object(s.jsx)(s.Fragment,{children:"Create Game"})})})]})]})}var g=n(365),w=n(359),k=n(48);function S(){var e=Object(o.useContext)(h.a),t=Object(l.f)().push,n=Object(o.useState)([]),r=Object(c.a)(n,2),f=r[0],j=r[1];function p(){return(p=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=j,t.next=3,e.gamesList();case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(o.useEffect)((function(){!function(){p.apply(this,arguments)}()}),[e]);var d=f.sort((function(e,t){return e.lastUpdated-t.lastUpdated})).map((function(e){return{name:Object(s.jsx)(k.b,{to:"/games/".concat(e.name),children:e.name}),key:e.name,players:e.players,status:"Lobby"===e.kind?"Not Started":"In Progress"}}));return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Games"}),Object(s.jsxs)("p",{className:"games-buttons",children:[Object(s.jsx)(u.a,{icon:Object(s.jsx)(g.a,{}),type:"dashed",onClick:function(){t("/games/create")},children:"Create Game"}),Object(s.jsx)(u.a,{icon:Object(s.jsx)(g.a,{}),type:"dashed",disabled:!0,onClick:function(){t("/games/join")},children:"Join Game"})]}),Object(s.jsx)(w.a,{columns:[{title:"Name",dataIndex:"name"},{title:"Players",dataIndex:"players"},{title:"Status",dataIndex:"status"}],dataSource:d,locale:{emptyText:"You are not in any games."},pagination:!1})]})}var I=n(207),M=n(366),T=n(363),F=n(134),C=n(89),A=n(66),E=n(67);n(347);function P(e){var t=function(e){var t=0,n=0;return e.forEach((function(e){var r=Object(c.a)(e.position,2),a=r[0],s=r[1];a>t&&(t=a),s>n&&(n=s)})),{width:t,height:n}}(e.systems),n=t.width,r=t.height;n+=1,r+=1;var a,i=Object(E.b)(r,n),u=Object(E.b)(r,n),o=Object(A.a)(e.systems);try{for(o.s();!(a=o.n()).done;){var l=a.value,h=Object(c.a)(l.position,2),f=h[0],j=h[1];u[j][f]="".concat((l.status||"").toLowerCase()),i[j][f]=Object(s.jsx)(s.Fragment,{children:l.name.substring(0,1).toUpperCase()})}}catch(p){o.e(p)}finally{o.f()}return Object(s.jsx)("table",{className:"map-preview",children:Object(s.jsx)("tbody",{children:Object(E.c)(r).map((function(e){return Object(s.jsx)("tr",{children:Object(E.c)(n).map((function(t){return Object(s.jsx)("td",{className:u[e][t],children:i[e][t]},t)}))},e)}))})})}function G(e){var t=Object(o.useContext)(h.a),n=Object(l.f)().replace,r=new Array(e.data.players-1).fill(""),f=Object(o.useState)(e.data.seed),b=Object(c.a)(f,2),m=b[0],O=b[1],v=Object(o.useState)(!1),y=Object(c.a)(v,2),g=y[0],w=y[1],k=Object(o.useState)(Math.ceil(3*e.data.players)),S=Object(c.a)(k,2),A=S[0],E=S[1],G=Object(o.useState)([]),N=Object(c.a)(G,2),L=N[0],W=N[1];return Object(o.useEffect)((function(){var t=new x.a(m),n=A/26,r=new C.a([Math.ceil(50*n),Math.ceil(30*n)],4,void 0,t),a=new F.a(r,t);W(a.generateMap(A,e.data.players))}),[m,A]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h3",{children:"Players"}),Object(s.jsxs)(T.b,{children:[Object(s.jsx)(T.b.Item,{children:Object(s.jsx)(T.b.Item.Meta,{avatar:Object(s.jsx)(I.a,{}),title:"Human",description:"Ready"})}),r.map((function(e,t){return Object(s.jsx)(T.b.Item,{children:Object(s.jsx)(T.b.Item.Meta,{avatar:Object(s.jsx)(M.a,{}),title:"AI: ".concat(t+1),description:"Ready"})},t)}))]}),Object(s.jsx)("h3",{children:"Settings"}),Object(s.jsxs)(j.a,{labelCol:{span:1},wrapperCol:{span:4},onFinish:function(){w(!0),e.onStart(m,A)},children:[Object(s.jsx)(j.a.Item,{label:"Name",extra:Object(s.jsx)(s.Fragment,{children:"Used for identifying the game only."}),children:Object(s.jsx)(p.a,{readOnly:!0,minLength:10,maxLength:20,value:e.data.name})}),Object(s.jsx)(j.a.Item,{label:"Seed",extra:Object(s.jsx)(s.Fragment,{children:"Used for procedural generation of systems."}),children:Object(s.jsx)(p.a,{readOnly:!0,minLength:10,maxLength:20,value:m,onChange:function(e){return O(e.target.value)}})}),Object(s.jsx)(j.a.Item,{label:"Preview",children:Object(s.jsx)(P,{systems:L})}),Object(s.jsx)(j.a.Item,{label:"Maximum Systems",extra:Object(s.jsx)(s.Fragment,{children:"A recommended number is 3 systems per player."}),children:Object(s.jsx)(d.a,{min:e.data.players,max:26,value:A,onChange:function(e){return E(parseInt("".concat(e)))}})}),Object(s.jsxs)("p",{className:"games-buttons",children:[Object(s.jsx)(u.a,{type:"primary",htmlType:"submit",disabled:g,children:"Start"}),Object(s.jsx)(u.a,{danger:!0,disabled:g,onClick:Object(i.a)(a.a.mark((function r(){return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return w(!0),r.next=3,t.gamesDelete(e.data.name);case 3:n("/games");case 4:case"end":return r.stop()}}),r)}))),children:"Delete"})]})]})]})}var N=n(360);n(348);function L(e){var t=Object(o.useState)(!1),n=Object(c.a)(t,2),r=n[0],l=n[1],h=Object(o.useState)(),f=Object(c.a)(h,2),j=f[0],p=f[1],d=e.endedTurn||r;return Object(o.useEffect)((function(){return function(){clearTimeout(j)}}),[]),Object(s.jsxs)("header",{className:"game-header",children:[Object(s.jsxs)("div",{children:[Object(s.jsx)("strong",{children:e.name}),Object(s.jsx)("br",{}),Object(s.jsx)("span",{children:e.players})," players, ",Object(s.jsx)("span",{children:e.systems})," ","systems."]}),Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{children:Object(s.jsx)(u.a,{type:"primary",disabled:d,onClick:Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),t.next=3,e.onEndTurn();case 3:n=setTimeout((function(){l(!1)}),2e3),p(n);case 5:case"end":return t.stop()}}),t)}))),children:d?"Waiting...":"End Turn"})}),Object(s.jsx)("li",{children:Object(s.jsx)(u.a,{danger:!0,onClick:Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.confirm("Are you sure? This will remove you from the game")){t.next=2;break}return t.abrupt("return");case 2:return l(!0),t.next=5,e.onResign();case 5:l(!1);case 6:case"end":return t.stop()}}),t)}))),children:"Resign"})})]})]})}function W(e){var t=e.state;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(L,{name:t.name,players:t.players,systems:t.systems.length,endedTurn:t.endedTurn,onEndTurn:e.onEndTurn,onResign:e.onResign}),Object(s.jsxs)(N.a,{defaultActiveKey:"1",children:[Object(s.jsx)(N.a.TabPane,{tab:"Overview",children:Object(s.jsx)(P,{systems:t.systems})},"1"),Object(s.jsx)(N.a.TabPane,{tab:"Reports"},"2"),Object(s.jsx)(N.a.TabPane,{tab:"Systems"},"3"),Object(s.jsx)(N.a.TabPane,{tab:"Fleets"},"4")]})]})}function R(){var e=Object(l.g)(),t=Object(o.useContext)(h.a),n=Object(o.useState)(),r=Object(c.a)(n,2),f=r[0],j=r[1];function p(){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.gamesFetch(e.name);case 2:r=n.sent,j(r);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}Object(o.useEffect)((function(){p();var e=setInterval(p,1e3);return function(){clearInterval(e)}}),[t]);var b=Object(l.f)().goBack;return f?"Lobby"===f.kind?Object(s.jsx)(G,{data:f,onStart:function(){var n=Object(i.a)(a.a.mark((function n(r,s){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=j,n.next=3,t.gamesStart(e.name,r,s);case 3:n.t1=n.sent,(0,n.t0)(n.t1);case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}):Object(s.jsx)(W,{state:f,onResign:Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.gameResign(f.name);case 2:case"end":return e.stop()}}),e)}))),onEndTurn:Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.gameEndTurn(f.name);case 2:case"end":return e.stop()}}),e)})))}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("h1",{children:["Game ",Object(s.jsx)("code",{children:e.name})," not found."]}),Object(s.jsx)("p",{children:"Either this game has been deleted, or the link is expired."}),Object(s.jsx)(u.a,{onClick:b,children:"Go Back"})]})}function q(){return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)(l.c,{children:[Object(s.jsx)(l.a,{exact:!0,path:"/games/create",component:y}),Object(s.jsx)(l.a,{path:"/games/:name",component:R}),Object(s.jsx)(l.a,{exact:!0,path:"/games",component:S})]})})}},208:function(e,t,n){"use strict";n.r(t);var r=n(4),a=(n(0),n(40)),s=n.n(a),i=n(173);n(353);s.a.render(Object(r.jsx)(i.a,{}),document.getElementById("root"))},216:function(e,t,n){},217:function(e,t,n){},307:function(e,t,n){},311:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},351:function(e,t,n){},353:function(e,t,n){},65:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(8),a=n.n(r),s=n(20),i=n(37),c=n(42),u=n(153),o=n(76),l=n(108),h=n(107),f=n(0),j=n.n(f),p=function e(){Object(i.a)(this,e)},d=n(203),b=n(31),m=n(60),O=n(66),x=n(134),v=n(89),y=n(67);function g(e,t){var n,r=Object(O.a)(e.players);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.userId===t)return a.fogOfWar}}catch(s){r.e(s)}finally{r.f()}}var w=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"createInitialFogOfWar",value:function(e,t,n){var r=this;return{kind:"Game",currentTurn:e.currentTurn,name:e.name,players:e.players.length,endedTurn:t,systems:e.systems.map((function(e){return{name:e.name,position:e.position,status:r.determineStatus(e,n)}}))}}},{key:"determineStatus",value:function(e,t){if("Empire"!==e.owner)return e.owner.player===t?"Self":void 0}}]),e}(),k=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"randomEmpireFactories",value:function(e,t){return e.nextInt(Math.floor(t/4),Math.floor(t/2))}},{key:"spawnEmpireFleet",value:function(e){return{transports:0,troops:0,warships:1*e.nextInt(10,30)}}},{key:"spawnPlayerFleet",value:function(e){var t=e.nextInt(180,240),n=e.nextInt(20,30);return{transports:n,troops:50*n,warships:t}}},{key:"spawnPlanet",value:function(e,t){return{morale:1,owner:t,troops:e.nextInt(20,80),recruit:e.nextInt(1,10)}}},{key:"spawnInitialSystems",value:function(e,t,n,r){var a=this,s=t/26,i=new v.a([Math.ceil(50*s),Math.ceil(30*s)],4,void 0,e),c=new x.a(i,e);return r=Object(y.a)(r).sort((function(){return e.nextInt(-1,1)})),c.generateMap(t,r.length).map((function(t){var s,i,c,u;return t.home?(s={player:r.splice(0,1)[0].userId},i=a.spawnPlayerFleet(e),c=n.initialFactories,u=new Array(10).fill(null).map((function(){return a.spawnPlanet(e,s)}))):(s="Empire",i=a.spawnEmpireFleet(e),c=a.randomEmpireFactories(e,n.initialFactories),u=new Array(e.nextInt(2,5)).fill(null).map((function(){return a.spawnPlanet(e,s)}))),{name:t.name,home:s,owner:s,position:t.position,orbit:i,factories:c,planets:u}}))}}]),e}(),S=function(){function e(){Object(i.a)(this,e)}return Object(c.a)(e,[{key:"nextTurn",value:function(e){return Object(b.a)(Object(b.a)({},e),{},{currentTurn:e.currentTurn+1,players:e.players.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{fogOfWar:Object(b.a)(Object(b.a)({},e.fogOfWar),{},{currentTurn:e.fogOfWar.currentTurn+1,endedTurn:e.serverAgent})})}))})}}]),e}(),I=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage;return Object(i.a)(this,n),(e=t.call(this,function(){var e=r.getItem("games");return e?JSON.parse(e):{}}())).storage=r,e}return Object(c.a)(n,[{key:"writeState",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(Object(o.a)(n.prototype),"writeState",this).call(this,t,r);case 2:return s=e.sent,this.storage.setItem("games",JSON.stringify(this.games)),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteState",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(Object(o.a)(n.prototype),"deleteState",this).call(this,t);case 2:this.storage.setItem("games",JSON.stringify(this.games));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new m.a;Object(i.a)(this,e),this.games=t,this.prando=n,this.fogOfWar=new w,this.spawner=new k,this.turnProcessor=new S}return Object(c.a)(e,[{key:"readState",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.games[t],e.abrupt("return",n?Object(y.a)(n):void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"writeState",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(b.a)(Object(b.a)({},Object(y.a)(n)),{},{lastUpdated:this.currentTime()}),e.abrupt("return",this.games[t]=n);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteState",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.games[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"currentTime",value:function(){return(new Date).getTime()}},{key:"writePlayer",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n,r){var s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readState(t);case 2:if(!(s=e.sent)||"Game"!==s.kind){e.next=6;break}for(i=0;i<s.players.length;i++)s.players[i].userId===n&&(s.players[i]=r(s.players[i]));return e.abrupt("return",this.writeState(t,s));case 6:return e.abrupt("return");case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onAccountLogin",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onGamesFetch",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r,s,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,s=Object.values(this.games);case 1:if(!(r<s.length)){e.next=12;break}if((i=s[r]).name!==n){e.next=9;break}if("Lobby"!==i.kind){e.next=8;break}return e.abrupt("return",i);case 8:return e.abrupt("return",g(i,t));case 9:r++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGamesList",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object.values(this.games).map((function(e){return{name:e.name,kind:e.kind,lastUpdated:e.lastUpdated,players:"number"===typeof e.players?e.players:e.players.length}})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onGamesCreate",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.writeState(n.name,Object(b.a)(Object(b.a)({},n),{},{seed:this.prando.nextString(10),createdBy:t,kind:"Lobby",lastUpdated:this.currentTime()})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGamesDelete",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.deleteState(n.name));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGamesStart",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r,s,i,c,u,o,l=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.readState(n.name);case 2:return r=e.sent,s=[{name:"Human",userId:"Guest",fogOfWar:{},serverAgent:!1}].concat(Object(d.a)(new Array(r.players-1).fill(null).map((function(e,t){return{name:"AI ".concat(t+1),userId:"ai-".concat(t+1),fogOfWar:{},serverAgent:!0}})))),i={initialFactories:10,shipSpeedATurn:4},c=this.spawner.spawnInitialSystems(new m.a(n.seed),n.systems,i,s),u={name:r.name,lastUpdated:this.currentTime(),createdBy:t,currentTurn:1,kind:"Game",players:s,systems:c,settings:i},o=Object(b.a)(Object(b.a)({},u),{},{players:u.players.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{fogOfWar:l.fogOfWar.createInitialFogOfWar(u,e.serverAgent,e.userId)})}))}),e.next=10,this.writeState(n.name,o);case 10:return e.abrupt("return",g(o,t));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameEndTurn",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writePlayer(n.name,t,(function(e){return Object(b.a)(Object(b.a)({},e),{},{fogOfWar:Object(b.a)(Object(b.a)({},e.fogOfWar),{},{endedTurn:!0})})}));case 2:if(!(r=e.sent)){e.next=8;break}if(!r.players.every((function(e){return e.fogOfWar.endedTurn}))){e.next=8;break}return e.next=8,this.writeState(n.name,this.turnProcessor.nextTurn(r));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameResign",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.writePlayer(n.name,t,(function(e){return Object(b.a)(Object(b.a)({},e),{},{serverAgent:!0,fogOfWar:Object(b.a)(Object(b.a)({},e.fogOfWar),{},{endedTurn:!0})})}));case 2:if(!(r=e.sent)){e.next=14;break}if(!r.players.every((function(e){return e.serverAgent}))){e.next=10;break}return e.next=8,this.deleteState(n.name);case 8:e.next=14;break;case 10:if(!r.players.every((function(e){return e.fogOfWar.endedTurn}))){e.next=14;break}return e.next=14,this.writeState(n.name,this.turnProcessor.nextTurn(r));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()),M=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Guest",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new I;return Object(i.a)(this,n),(e=t.call(this)).player=r,e.server=a,e}return Object(c.a)(n,[{key:"accountLogin",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"accountLogout",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"gamesFetch",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGamesFetch(this.player,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gamesList",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGamesList());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gamesDelete",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGamesDelete(this.player,{name:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gamesCreate",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGamesCreate(this.player,{name:t,players:n}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"gamesStart",value:function(){var e=Object(s.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGamesStart(this.player,{name:t,seed:n,systems:r}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"gameEndTurn",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGameEndTurn(this.player,{name:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"gameResign",value:function(){var e=Object(s.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.server.onGameResign(this.player,{name:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(p),T=j.a.createContext(new M)},67:function(e,t,n){"use strict";function r(e){return JSON.parse(JSON.stringify(e))}function a(e){return new Array(e).fill(null).map((function(e,t){return t}))}function s(e,t){return new Array(e).fill(null).map((function(){return new Array(t).fill(null)}))}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}))},89:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37),a=n(42),s=n(60);var i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new s.a;Object(r.a)(this,e),this.prando=i,this.xMin=0,this.yMin=0,this.xMax=void 0,this.yMax=void 0,this.radius=void 0,this.cellSize=void 0,this.k=void 0,this.state=void 0,this.queue=void 0,this.firstPoint=!0,this.xMax=t[0],this.yMax=t[1],this.radius=Math.max(n,1),this.cellSize=this.radius*Math.SQRT1_2,this.k=Math.max(a,2),this.reset()}return Object(a.a)(e,[{key:"reset",value:function(){var e=Math.ceil((this.xMax-this.xMin)/this.cellSize),t=Math.ceil((this.yMax-this.yMin)/this.cellSize);this.state={width:e,height:t,data:new Array(e*t).fill(null)},this.queue=[],this.firstPoint=!0}},{key:"createPoint",value:function(e,t){var n=Math.floor(e/this.cellSize)+Math.floor(t/this.cellSize)*this.state.width,r=this.state.data[n]=[e,t];return this.queue.push(r),r}},{key:"isValidPoint",value:function(e,t){if(e<this.xMin||e>this.xMax||t<this.yMin||t>this.yMax)return!1;for(var n,r,a,s,i=Math.floor((e-this.xMin)/this.cellSize),c=Math.floor((t-this.yMin)/this.cellSize),u=0,o=i-2;o<=i+2;o++)for(var l=c-2;l<=c+2;l++)if(o>=0&&o<this.state.width&&l>=0&&l<this.state.height&&(u=o+l*this.state.width,null!==this.state.data[u]&&(n=e,r=t,a=this.state.data[u][0],s=this.state.data[u][1],(a-n)*(a-n)+(s-r)*(s-r)<=this.radius*this.radius)))return!1;return!0}},{key:"rng",value:function(){return this.prando.next()}},{key:"nextPoint",value:function(){var e=0,t=0;if(this.firstPoint)return this.firstPoint=!1,e=this.xMin+(this.xMax-this.xMin)*this.rng(),t=this.yMin+(this.yMax-this.yMin)*this.rng(),this.createPoint(e,t);for(var n=0,r=0,a=0;this.queue.length;){n=this.queue.length*this.rng()|0;for(var s=0;s<this.k;s++)if(r=this.radius*(this.rng()+1),a=2*Math.PI*this.rng(),e=this.queue[n][0]+r*Math.cos(a),t=this.queue[n][1]+r*Math.sin(a),this.isValidPoint(e,t))return this.createPoint(e,t);this.queue.splice(n,1)}return null}},{key:"points",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.MAX_SAFE_INTEGER,t=[],n=0;n<e;n++){var r=this.nextPoint();r&&t.push(r)}return t}},{key:"done",get:function(){return!this.firstPoint&&0===this.queue.length}}]),e}()}},[[208,1,2]]]);
//# sourceMappingURL=main.85fc15ca.chunk.js.map